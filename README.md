# このプログラムの作成経緯
学習の際にOnenoteの画像内の文字列を検索できる機能を利用するために作成。

Onenoteは一定の画像サイズを超えると画像を表示しなくなるため、大きすぎる画像は分割する必要があった。

# 動作確認の方法
## 環境構築
```
pip install selenium pillow chromedriver-binary==バージョン
```
で必要なライブラリをインストールしてください。
chromedriver-binaryのバージョンに関しては以下の説明をご覧ください。

### chromedriver-binaryのバージョンについて
[chromedriver binary のバージョン一覧](https://anaconda.org/conda-forge/python-chromedriver-binary/files)
を参照し、ご利用のChromeのバージョン以下(可能な限り近いもの)のバージョンをお調べいただき

pip install chromedriver-binary==バージョン

でインストールしてください。
(例)pip install chromedriver-binary==131.0.6778.85.0

なお、面倒な場合はChromeのバージョンをまず入れて、対応するバージョンがない場合はエラーでバージョン一覧が出てくるのでそこから選ぶのがいいかもしれません

## 実際に動かす
### 自動スクリーンショット.ipynb
Crawling of HTML 内の ```target_dir``` に画像化したいHTMLファイルが入ったフォルダの**親フォルダの**パスを入れてください

※親ファイルなのはスクリーンショットを入れるフォルダ作成のため。そのまま中に作ってもよかったが、構造が深くなって面倒だと思ったので...

(例)
>root
>>HTML

であれば ```root```までのパスを変数に代入してください

以上の操作後に実行すると```target_dir```以下に```スクリーンショット```という名前のファイルが生成され、内部にスクリーンショットが入っています。

※元々講義で配布された資料用に作成したもののため、ファイル名に```.pptx - Google スライド.html```が含まれている場合は削除するようになっています。

### split.ipynb
以下の変数に適切な文字列または数値を入れて、実行すれば対象ファイル内の画像(.pngのみ)の縦幅が閾値を超えると分割されます。
```
subject = 教科名。※今回の動作確認では以下の2つのパスを直接指定すれば必要ありません。
source_folder = 元のPNG画像があるフォルダへのパス
output_folder = 分割後の画像を保存するフォルダへのパス
target_height = 画像の縦幅の最大値。これより大きい画像は分割される
```
